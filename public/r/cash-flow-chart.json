{
  "$schema": "https://ui.shadcn.com/schema/registry-item.json",
  "name": "cash-flow-chart",
  "type": "registry:ui",
  "title": "Gráfico de Fluxo de Caixa Acessível",
  "description": "Gráfico de barras interativo de fluxo de caixa com foco no teclado, dicas e suporte a leitores de tela",
  "dependencies": [
    "framer-motion",
    "react"
  ],
  "files": [
    {
      "path": "components/data/charts/cash-flow-chart.tsx",
      "content": "\"use client\";\r\n\r\nimport { useMemo, useState } from \"react\";\r\nimport { AnimatePresence, motion, useReducedMotion } from \"framer-motion\";\r\nimport { cn } from \"@/lib/utils\";\r\n\r\ntype ChartView = \"monthly\" | \"yearly\";\r\n\r\ninterface CashFlowDatum {\r\n  label: string;\r\n  shortLabel: string;\r\n  value: number;\r\n  cashflow: number;\r\n  inflow: number;\r\n  dateRange: string;\r\n}\r\n\r\nconst monthlyData: CashFlowDatum[] = [\r\n  {\r\n    label: \"January 2026\",\r\n    shortLabel: \"Jan\",\r\n    value: 35000,\r\n    cashflow: 35000,\r\n    inflow: 12000,\r\n    dateRange: \"January 2026\",\r\n  },\r\n  {\r\n    label: \"February 2026\",\r\n    shortLabel: \"Feb\",\r\n    value: 28000,\r\n    cashflow: 28000,\r\n    inflow: 9500,\r\n    dateRange: \"February 2026\",\r\n  },\r\n  {\r\n    label: \"March 2026\",\r\n    shortLabel: \"Mar\",\r\n    value: 52000,\r\n    cashflow: 52000,\r\n    inflow: 14200,\r\n    dateRange: \"March 2026\",\r\n  },\r\n  {\r\n    label: \"April 2026\",\r\n    shortLabel: \"Apr\",\r\n    value: 31000,\r\n    cashflow: 31000,\r\n    inflow: 10100,\r\n    dateRange: \"April 2026\",\r\n  },\r\n  {\r\n    label: \"May 2026\",\r\n    shortLabel: \"May\",\r\n    value: 38000,\r\n    cashflow: 38000,\r\n    inflow: 11800,\r\n    dateRange: \"May 2026\",\r\n  },\r\n  {\r\n    label: \"June 2026\",\r\n    shortLabel: \"Jun\",\r\n    value: 22000,\r\n    cashflow: 22000,\r\n    inflow: 8200,\r\n    dateRange: \"June 2026\",\r\n  },\r\n  {\r\n    label: \"July 2026\",\r\n    shortLabel: \"Jul\",\r\n    value: 33000,\r\n    cashflow: 33000,\r\n    inflow: 9600,\r\n    dateRange: \"July 2026\",\r\n  },\r\n];\r\n\r\nconst yearlyData: CashFlowDatum[] = [\r\n  {\r\n    label: \"2020\",\r\n    shortLabel: \"2020\",\r\n    value: 265000,\r\n    cashflow: 265000,\r\n    inflow: 62000,\r\n    dateRange: \"Fiscal Year 2020\",\r\n  },\r\n  {\r\n    label: \"2021\",\r\n    shortLabel: \"2021\",\r\n    value: 302000,\r\n    cashflow: 302000,\r\n    inflow: 78500,\r\n    dateRange: \"Fiscal Year 2021\",\r\n  },\r\n  {\r\n    label: \"2022\",\r\n    shortLabel: \"2022\",\r\n    value: 358000,\r\n    cashflow: 358000,\r\n    inflow: 91200,\r\n    dateRange: \"Fiscal Year 2022\",\r\n  },\r\n  {\r\n    label: \"2023\",\r\n    shortLabel: \"2023\",\r\n    value: 402000,\r\n    cashflow: 402000,\r\n    inflow: 103500,\r\n    dateRange: \"Fiscal Year 2023\",\r\n  },\r\n  {\r\n    label: \"2024\",\r\n    shortLabel: \"2024\",\r\n    value: 446000,\r\n    cashflow: 446000,\r\n    inflow: 118000,\r\n    dateRange: \"Fiscal Year 2024\",\r\n  },\r\n  {\r\n    label: \"2025\",\r\n    shortLabel: \"2025\",\r\n    value: 489000,\r\n    cashflow: 489000,\r\n    inflow: 124300,\r\n    dateRange: \"Fiscal Year 2025 (projected)\",\r\n  },\r\n];\r\n\r\nconst formatCurrency = (value: number) =>\r\n  new Intl.NumberFormat(\"en-US\", {\r\n    style: \"currency\",\r\n    currency: \"USD\",\r\n    maximumFractionDigits: 0,\r\n  }).format(value);\r\n\r\nexport function CashFlowChart() {\r\n  const [hoveredBar, setHoveredBar] = useState<number | null>(null);\r\n  const [activeView, setActiveView] = useState<ChartView>(\"yearly\");\r\n  const prefersReducedMotion = useReducedMotion();\r\n\r\n  const displayData = useMemo(\r\n    () => (activeView === \"monthly\" ? monthlyData : yearlyData),\r\n    [activeView]\r\n  );\r\n\r\n  const maxValue = useMemo(\r\n    () => Math.max(...displayData.map((d) => d.value)),\r\n    [displayData]\r\n  );\r\n\r\n  const summaryText = useMemo(() => {\r\n    if (!displayData.length) {\r\n      return \"No cash flow data available.\";\r\n    }\r\n\r\n    const highest = displayData.reduce((prev, current) =>\r\n      current.value > prev.value ? current : prev\r\n    );\r\n    const lowest = displayData.reduce((prev, current) =>\r\n      current.value < prev.value ? current : prev\r\n    );\r\n    const first = displayData[0];\r\n    const last = displayData[displayData.length - 1];\r\n\r\n    if (activeView === \"monthly\") {\r\n      return `Monthly cash flow from ${first.label} to ${last.label}. Highest cash flow in ${highest.label} at ${formatCurrency(\r\n        highest.value\r\n      )}. Lowest in ${lowest.label} at ${formatCurrency(lowest.value)}.`;\r\n    }\r\n\r\n    return `Yearly cash flow from ${first.label} to ${last.label}. Highest cash flow in ${highest.label} at ${formatCurrency(\r\n      highest.value\r\n    )}. Lowest in ${lowest.label} at ${formatCurrency(lowest.value)}.`;\r\n  }, [activeView, displayData]);\r\n\r\n  const chartTitleId = \"cashflow-chart-title\";\r\n  const chartSummaryId = \"cashflow-chart-summary\";\r\n\r\n  const handleViewChange = (view: ChartView) => {\r\n    setActiveView(view);\r\n    setHoveredBar(null);\r\n  };\r\n\r\n  const shouldAnimate = !prefersReducedMotion;\r\n\r\n  return (\r\n    <motion.section\r\n      initial={shouldAnimate ? { opacity: 0, y: 20 } : { opacity: 1, y: 0 }}\r\n      animate={{ opacity: 1, y: 0 }}\r\n      transition={shouldAnimate ? { duration: 0.5 } : { duration: 0 }}\r\n      className=\"w-full bg-card rounded-3xl p-8 hover:shadow-2xl backdrop-blur-sm border border-border\"\r\n      aria-labelledby={chartTitleId}\r\n      aria-describedby={chartSummaryId}\r\n      role=\"group\"\r\n    >\r\n      <div className=\"grid grid-cols-1 md:flex items-start justify-between mb-8 gap-6\">\r\n        <div>\r\n          <p\r\n            className=\"text-muted-foreground text-lg mb-2\"\r\n            id=\"cashflow-chart-label\"\r\n          >\r\n            Cash Flow\r\n          </p>\r\n          <motion.h2\r\n            id={chartTitleId}\r\n            initial={shouldAnimate ? { scale: 0.95 } : { scale: 1 }}\r\n            animate={{ scale: 1 }}\r\n            transition={shouldAnimate ? { duration: 0.4 } : { duration: 0 }}\r\n            className=\"text-5xl font-bold text-foreground\"\r\n          >\r\n            {formatCurrency(\r\n              displayData.reduce((total, datum) => total + datum.cashflow, 0)\r\n            )}\r\n          </motion.h2>\r\n          <p id={chartSummaryId} className=\"sr-only\" aria-live=\"polite\">\r\n            {summaryText}\r\n          </p>\r\n        </div>\r\n\r\n        <div\r\n          className=\"flex bg-secondary rounded-full p-1 w-fit\"\r\n          role=\"radiogroup\"\r\n          aria-label=\"Chart view\"\r\n        >\r\n          <button\r\n            type=\"button\"\r\n            onClick={() => handleViewChange(\"monthly\")}\r\n            className={cn(\r\n              \"px-6 py-2 rounded-full text-sm font-medium transition-all duration-300 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-primary focus-visible:ring-offset-2 focus-visible:ring-offset-secondary\",\r\n              activeView === \"monthly\"\r\n                ? \"bg-primary text-primary-foreground shadow-lg\"\r\n                : \"text-foreground hover:text-primary\"\r\n            )}\r\n            aria-pressed={activeView === \"monthly\"}\r\n            aria-controls=\"cashflow-chart-bars\"\r\n          >\r\n            Monthly\r\n          </button>\r\n          <button\r\n            type=\"button\"\r\n            onClick={() => handleViewChange(\"yearly\")}\r\n            className={cn(\r\n              \"px-6 py-2 rounded-full text-sm font-medium transition-all duration-300 flex items-center gap-2 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-primary focus-visible:ring-offset-2 focus-visible:ring-offset-secondary\",\r\n              activeView === \"yearly\"\r\n                ? \"bg-primary text-primary-foreground shadow-lg\"\r\n                : \"text-foreground hover:text-primary\"\r\n            )}\r\n            aria-pressed={activeView === \"yearly\"}\r\n            aria-controls=\"cashflow-chart-bars\"\r\n          >\r\n            <span className=\"sr-only\">Currently selected:&nbsp;</span>\r\n            Yearly\r\n          </button>\r\n        </div>\r\n      </div>\r\n\r\n      <figure\r\n        className=\"relative h-auto overflow-x-auto md:overflow-x-visible overflow-y-hidden md:overflow-y-visible pt-10 md:pt-0\"\r\n        aria-labelledby={chartTitleId}\r\n      >\r\n        <figcaption className=\"sr-only\">\r\n          Bar chart comparing cash flow performance by period. Use the Monthly\r\n          or Yearly toggle to change the data set.\r\n        </figcaption>\r\n\r\n        <div className=\"relative min-w-[640px] md:min-w-0 h-[24rem]\">\r\n          <div\r\n            className=\"absolute left-0 top-0 bottom-12 flex flex-col justify-between text-sm text-muted-foreground\"\r\n            aria-hidden=\"true\"\r\n          >\r\n            {[50, 40, 30, 20, 10, 0].map((value) => (\r\n              <div key={value}>{value}k</div>\r\n            ))}\r\n          </div>\r\n\r\n          <div\r\n            id=\"cashflow-chart-bars\"\r\n            className=\"absolute left-16 right-0 top-0 bottom-12 flex items-end justify-between gap-4\"\r\n            role=\"list\"\r\n            aria-describedby={chartSummaryId}\r\n          >\r\n            {displayData.map((data, index) => {\r\n              const heightPercentage = maxValue\r\n                ? Math.max((data.value / maxValue) * 100, 4)\r\n                : 0;\r\n              // Keep tooltip inside the chart area so it doesn't get clipped\r\n              const tooltipBase = Math.min(heightPercentage + 8, 88);\r\n              const tooltipVisible = hoveredBar === index;\r\n              const tooltipPosition = `${tooltipBase}%`;\r\n\r\n              return (\r\n                <div\r\n                  key={`${data.shortLabel}-${data.label}`}\r\n                  className=\"relative flex-1 flex flex-col items-center justify-end h-full\"\r\n                  onMouseEnter={() => setHoveredBar(index)}\r\n                  onMouseLeave={() => setHoveredBar(null)}\r\n                  role=\"listitem\"\r\n                >\r\n                  <AnimatePresence>\r\n                    {tooltipVisible && (\r\n                      <motion.div\r\n                        initial={\r\n                          shouldAnimate\r\n                            ? { opacity: 0, y: 10, scale: 0.95 }\r\n                            : { opacity: 1, y: 0, scale: 1 }\r\n                        }\r\n                        animate={{ opacity: 1, y: 0, scale: 1 }}\r\n                        exit={\r\n                          shouldAnimate\r\n                            ? { opacity: 0, y: 10, scale: 0.95 }\r\n                            : { opacity: 0, y: 10, scale: 0.95 }\r\n                        }\r\n                        transition={\r\n                          shouldAnimate ? { duration: 0.2 } : { duration: 0 }\r\n                        }\r\n                        className=\"absolute mx-auto bg-popover rounded-2xl p-4 shadow-xl border border-border min-w-[200px] z-10 text-left\"\r\n                        role=\"status\"\r\n                        aria-live=\"polite\"\r\n                        style={{ bottom: tooltipPosition }}\r\n                      >\r\n                        <div className=\"text-xs text-muted-foreground mb-2\">\r\n                          {data.dateRange}\r\n                        </div>\r\n                        <div className=\"flex justify-between items-center mb-1\">\r\n                          <span className=\"text-sm text-foreground\">\r\n                            Cash flow\r\n                          </span>\r\n                          <span className=\"text-sm font-semibold text-foreground\">\r\n                            {formatCurrency(data.cashflow)}\r\n                          </span>\r\n                        </div>\r\n                        <div className=\"flex justify-between items-center\">\r\n                          <span className=\"text-sm text-foreground\">\r\n                            Inflow\r\n                          </span>\r\n                          <span className=\"text-sm font-semibold text-foreground\">\r\n                            {formatCurrency(data.inflow)}\r\n                          </span>\r\n                        </div>\r\n                      </motion.div>\r\n                    )}\r\n                  </AnimatePresence>\r\n\r\n                  <motion.button\r\n                    type=\"button\"\r\n                    initial={shouldAnimate ? { height: 0 } : false}\r\n                    animate={{ height: `${heightPercentage}%` }}\r\n                    transition={\r\n                      shouldAnimate\r\n                        ? {\r\n                            duration: 0.8,\r\n                            delay: index * 0.08,\r\n                            ease: \"easeOut\",\r\n                          }\r\n                        : { duration: 0 }\r\n                    }\r\n                    onFocus={() => setHoveredBar(index)}\r\n                    onBlur={() => setHoveredBar(null)}\r\n                    className={`w-full rounded-t-2xl relative overflow-hidden cursor-pointer transition-colors duration-300 min-h-[0.5rem] focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-primary focus-visible:ring-offset-2 focus-visible:ring-offset-background ${tooltipVisible ? \"bg-gradient-to-b from-primary to-primary/20\" : \"bg-primary/30\"}\r\n                    `}\r\n                    aria-label={`${data.label} cash flow ${formatCurrency(\r\n                      data.cashflow\r\n                    )} with ${formatCurrency(data.inflow)} in inflow`}\r\n                    aria-describedby={`${data.shortLabel}-summary`}\r\n                  >\r\n                    <span id={`${data.shortLabel}-summary`} className=\"sr-only\">\r\n                      {`${data.label}: cash flow ${formatCurrency(\r\n                        data.cashflow\r\n                      )}, inflow ${formatCurrency(data.inflow)}`}\r\n                    </span>\r\n                  </motion.button>\r\n\r\n                  <div\r\n                    className=\"text-sm text-muted-foreground mt-3\"\r\n                    aria-hidden=\"true\"\r\n                  >\r\n                    {data.shortLabel}\r\n                  </div>\r\n                </div>\r\n              );\r\n            })}\r\n          </div>\r\n        </div>\r\n\r\n        <table className=\"sr-only\">\r\n          <caption>\r\n            Tabular representation of the cash flow data for assistive\r\n            technologies.\r\n          </caption>\r\n          <thead>\r\n            <tr>\r\n              <th scope=\"col\">Period</th>\r\n              <th scope=\"col\">Cash flow</th>\r\n              <th scope=\"col\">Inflow</th>\r\n            </tr>\r\n          </thead>\r\n          <tbody>\r\n            {displayData.map((datum) => (\r\n              <tr key={`table-${datum.label}`}>\r\n                <th scope=\"row\">{datum.label}</th>\r\n                <td>{formatCurrency(datum.cashflow)}</td>\r\n                <td>{formatCurrency(datum.inflow)}</td>\r\n              </tr>\r\n            ))}\r\n          </tbody>\r\n        </table>\r\n      </figure>\r\n    </motion.section>\r\n  );\r\n}\r\n",
      "type": "registry:ui",
      "target": "components/data/charts/cash-flow-chart"
    }
  ]
}