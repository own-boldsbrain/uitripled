{
  "$schema": "https://ui.shadcn.com/schema/registry-item.json",
  "name": "kanban-board",
  "type": "registry:block",
  "title": "Quadro Kanban",
  "description": "Quadro Kanban interativo com arrastar e soltar, estilo glassmorfismo e recursos de gerenciamento de tarefas",
  "registryDependencies": [
    "button"
  ],
  "dependencies": [
    "framer-motion",
    "react"
  ],
  "files": [
    {
      "path": "components/components/kanban/kanban-board.tsx",
      "content": "\"use client\";\r\n\r\nimport React, { useState, useMemo } from \"react\";\r\nimport {\r\n  DndContext,\r\n  DragOverlay,\r\n  closestCorners,\r\n  KeyboardSensor,\r\n  PointerSensor,\r\n  useSensor,\r\n  useSensors,\r\n  DragStartEvent,\r\n  DragOverEvent,\r\n  DragEndEvent,\r\n  defaultDropAnimationSideEffects,\r\n  DropAnimation,\r\n} from \"@dnd-kit/core\";\r\nimport {\r\n  arrayMove,\r\n  SortableContext,\r\n  sortableKeyboardCoordinates,\r\n  verticalListSortingStrategy,\r\n  useSortable,\r\n  horizontalListSortingStrategy,\r\n} from \"@dnd-kit/sortable\";\r\nimport { CSS } from \"@dnd-kit/utilities\";\r\nimport { motion, AnimatePresence } from \"framer-motion\";\r\nimport {\r\n  Plus,\r\n  MoreHorizontal,\r\n  Calendar,\r\n  MessageSquare,\r\n  Paperclip,\r\n  GripVertical,\r\n  Trash2,\r\n  Search,\r\n  Filter,\r\n  LayoutGrid,\r\n  List,\r\n  Clock,\r\n  CheckCircle2,\r\n  AlertCircle,\r\n} from \"lucide-react\";\r\nimport { cn } from \"@/lib/utils\";\r\nimport { Button } from \"@/components/ui/button\";\r\nimport { Badge } from \"@/components/ui/badge\";\r\nimport { Avatar, AvatarFallback, AvatarImage } from \"@/components/ui/avatar\";\r\nimport {\r\n  DropdownMenu,\r\n  DropdownMenuContent,\r\n  DropdownMenuItem,\r\n  DropdownMenuTrigger,\r\n} from \"@/components/ui/dropdown-menu\";\r\nimport { Input } from \"@/components/ui/input\";\r\n\r\n// --- Types ---\r\n\r\ntype Id = string | number;\r\n\r\ntype Column = {\r\n  id: Id;\r\n  title: string;\r\n};\r\n\r\ntype Task = {\r\n  id: Id;\r\n  columnId: Id;\r\n  content: string;\r\n  priority: \"low\" | \"medium\" | \"high\";\r\n  tags: string[];\r\n  comments: number;\r\n  attachments: number;\r\n  dueDate?: string;\r\n  assignees: string[];\r\n};\r\n\r\n// --- Mock Data ---\r\n\r\nconst initialColumns: Column[] = [\r\n  { id: \"todo\", title: \"To Do\" },\r\n  { id: \"in-progress\", title: \"In Progress\" },\r\n  { id: \"review\", title: \"Review\" },\r\n  { id: \"done\", title: \"Done\" },\r\n];\r\n\r\nconst initialTasks: Task[] = [\r\n  {\r\n    id: \"1\",\r\n    columnId: \"todo\",\r\n    content: \"Design new landing page\",\r\n    priority: \"high\",\r\n    tags: [\"Design\", \"Marketing\"],\r\n    comments: 3,\r\n    attachments: 2,\r\n    dueDate: \"Amanhã\",\r\n    assignees: [\"/avatars/01.png\", \"/avatars/02.png\"],\r\n  },\r\n  {\r\n    id: \"2\",\r\n    columnId: \"todo\",\r\n    content: \"Competitor analysis\",\r\n    priority: \"medium\",\r\n    tags: [\"Research\"],\r\n    comments: 1,\r\n    attachments: 0,\r\n    dueDate: \"Próxima semana\",\r\n    assignees: [\"/avatars/03.png\"],\r\n  },\r\n  {\r\n    id: \"3\",\r\n    columnId: \"in-progress\",\r\n    content: \"Implement authentication flow\",\r\n    priority: \"high\",\r\n    tags: [\"Dev\", \"Backend\"],\r\n    comments: 5,\r\n    attachments: 1,\r\n    dueDate: \"Hoje\",\r\n    assignees: [\"/avatars/04.png\", \"/avatars/05.png\"],\r\n  },\r\n  {\r\n    id: \"4\",\r\n    columnId: \"in-progress\",\r\n    content: \"Fix navigation bug on mobile\",\r\n    priority: \"low\",\r\n    tags: [\"Bug\", \"Mobile\"],\r\n    comments: 0,\r\n    attachments: 0,\r\n    assignees: [\"/avatars/01.png\"],\r\n  },\r\n  {\r\n    id: \"5\",\r\n    columnId: \"review\",\r\n    content: \"Update documentation\",\r\n    priority: \"medium\",\r\n    tags: [\"Docs\"],\r\n    comments: 2,\r\n    attachments: 1,\r\n    dueDate: \"Yesterday\",\r\n    assignees: [\"/avatars/02.png\"],\r\n  },\r\n  {\r\n    id: \"6\",\r\n    columnId: \"done\",\r\n    content: \"Release v1.0.0\",\r\n    priority: \"high\",\r\n    tags: [\"Release\"],\r\n    comments: 12,\r\n    attachments: 4,\r\n    dueDate: \"Semana passada\",\r\n    assignees: [\"/avatars/01.png\", \"/avatars/02.png\", \"/avatars/03.png\"],\r\n  },\r\n];\r\n\r\n// --- Components ---\r\n\r\nexport function KanbanBoard() {\r\n  const [columns, setColumns] = useState<Column[]>(initialColumns);\r\n  const [tasks, setTasks] = useState<Task[]>(initialTasks);\r\n  const [activeColumn, setActiveColumn] = useState<Column | null>(null);\r\n  const [activeTask, setActiveTask] = useState<Task | null>(null);\r\n  const [searchQuery, setSearchQuery] = useState(\"\");\r\n\r\n  const sensors = useSensors(\r\n    useSensor(PointerSensor, {\r\n      activationConstraint: {\r\n        distance: 3, // 3px movement required before drag starts\r\n      },\r\n    }),\r\n    useSensor(KeyboardSensor, {\r\n      coordinateGetter: sortableKeyboardCoordinates,\r\n    })\r\n  );\r\n\r\n  const columnsId = useMemo(() => columns.map((col) => col.id), [columns]);\r\n\r\n  const filteredTasks = useMemo(() => {\r\n    if (!searchQuery) return tasks;\r\n    return tasks.filter((task) =>\r\n      task.content.toLowerCase().includes(searchQuery.toLowerCase())\r\n    );\r\n  }, [tasks, searchQuery]);\r\n\r\n  function onDragStart(event: DragStartEvent) {\r\n    if (event.active.data.current?.type === \"Column\") {\r\n      setActiveColumn(event.active.data.current.column);\r\n      return;\r\n    }\r\n\r\n    if (event.active.data.current?.type === \"Task\") {\r\n      setActiveTask(event.active.data.current.task);\r\n      return;\r\n    }\r\n  }\r\n\r\n  function onDragOver(event: DragOverEvent) {\r\n    const { active, over } = event;\r\n    if (!over) return;\r\n\r\n    const activeId = active.id;\r\n    const overId = over.id;\r\n\r\n    if (activeId === overId) return;\r\n\r\n    const isActiveTask = active.data.current?.type === \"Task\";\r\n    const isOverTask = over.data.current?.type === \"Task\";\r\n\r\n    if (!isActiveTask) return;\r\n\r\n    // Im dropping a Task over another Task\r\n    if (isActiveTask && isOverTask) {\r\n      setTasks((tasks) => {\r\n        const activeIndex = tasks.findIndex((t) => t.id === activeId);\r\n        const overIndex = tasks.findIndex((t) => t.id === overId);\r\n\r\n        if (tasks[activeIndex].columnId !== tasks[overIndex].columnId) {\r\n          tasks[activeIndex].columnId = tasks[overIndex].columnId;\r\n        }\r\n\r\n        return arrayMove(tasks, activeIndex, overIndex);\r\n      });\r\n    }\r\n\r\n    const isOverColumn = over.data.current?.type === \"Column\";\r\n\r\n    // Im dropping a Task over a column\r\n    if (isActiveTask && isOverColumn) {\r\n      setTasks((tasks) => {\r\n        const activeIndex = tasks.findIndex((t) => t.id === activeId);\r\n\r\n        tasks[activeIndex].columnId = overId;\r\n        console.log(\"DROPPING TASK OVER COLUMN\", { activeIndex });\r\n        return arrayMove(tasks, activeIndex, activeIndex);\r\n      });\r\n    }\r\n  }\r\n\r\n  function onDragEnd(event: DragEndEvent) {\r\n    setActiveColumn(null);\r\n    setActiveTask(null);\r\n\r\n    const { active, over } = event;\r\n    if (!over) return;\r\n\r\n    const activeId = active.id;\r\n    const overId = over.id;\r\n\r\n    if (activeId === overId) return;\r\n\r\n    const isActiveColumn = active.data.current?.type === \"Column\";\r\n    if (isActiveColumn) {\r\n      setColumns((columns) => {\r\n        const activeIndex = columns.findIndex((col) => col.id === activeId);\r\n        const overIndex = columns.findIndex((col) => col.id === overId);\r\n        return arrayMove(columns, activeIndex, overIndex);\r\n      });\r\n    }\r\n  }\r\n\r\n  const dropAnimation: DropAnimation = {\r\n    sideEffects: defaultDropAnimationSideEffects({\r\n      styles: {\r\n        active: {\r\n          opacity: \"0.5\",\r\n        },\r\n      },\r\n    }),\r\n  };\r\n\r\n  return (\r\n    <div className=\"relative flex h-full min-h-screen w-full flex-col gap-6 overflow-hidden bg-background p-6\">\r\n      {/* Glassmorphism background blobs */}\r\n      <div className=\"absolute inset-0 -z-10 pointer-events-none\">\r\n        <div className=\"absolute left-1/2 top-0 h-[520px] w-[520px] -translate-x-1/2 rounded-full bg-foreground/[0.035] blur-[140px]\" />\r\n        <div className=\"absolute bottom-0 right-0 h-[360px] w-[360px] rounded-full bg-foreground/[0.025] blur-[120px]\" />\r\n        <div className=\"absolute top-1/2 left-1/4 h-[400px] w-[400px] rounded-full bg-primary/[0.02] blur-[150px]\" />\r\n      </div>\r\n      {/* Header */}\r\n      <div className=\"relative flex flex-col gap-4 rounded-2xl border border-border/40 bg-background/60 p-6 backdrop-blur-xl md:flex-row md:items-center md:justify-between\">\r\n        {/* Gradient overlay */}\r\n        <div className=\"absolute inset-0 rounded-2xl bg-gradient-to-br from-foreground/[0.04] via-transparent to-transparent opacity-60\" />\r\n        <div className=\"relative z-10\">\r\n          <h1 className=\"text-3xl font-semibold tracking-tight text-foreground\">\r\n            Product Roadmap\r\n          </h1>\r\n          <p className=\"text-foreground/60\">\r\n            Manage tasks, track progress, and collaborate with your team.\r\n          </p>\r\n        </div>\r\n        <div className=\"flex items-center gap-2\">\r\n          <div className=\"relative\">\r\n            <Search className=\"absolute left-2.5 top-2.5 h-4 w-4 text-foreground/40\" />\r\n            <Input\r\n              placeholder=\"Search tasks...\"\r\n              className=\"w-[200px] pl-9 bg-background/60 border-border/50 backdrop-blur-md focus:bg-background/80 focus:border-border/70 transition-all\"\r\n              value={searchQuery}\r\n              onChange={(e) => setSearchQuery(e.target.value)}\r\n            />\r\n          </div>\r\n          <Button\r\n            variant=\"outline\"\r\n            size=\"icon\"\r\n            className=\"bg-background/60 border-border/50 backdrop-blur-md hover:bg-background/80\"\r\n          >\r\n            <Filter className=\"h-4 w-4 text-foreground/70\" />\r\n          </Button>\r\n          <Button className=\"gap-2 bg-primary text-primary-foreground hover:bg-primary/90 shadow-lg shadow-primary/20\">\r\n            <Plus className=\"h-4 w-4\" />\r\n            New Task\r\n          </Button>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Board */}\r\n      <DndContext\r\n        sensors={sensors}\r\n        collisionDetection={closestCorners}\r\n        onDragStart={onDragStart}\r\n        onDragOver={onDragOver}\r\n        onDragEnd={onDragEnd}\r\n      >\r\n        <div className=\"flex h-full gap-6 overflow-x-auto pb-4\">\r\n          <SortableContext\r\n            items={columnsId}\r\n            strategy={horizontalListSortingStrategy}\r\n          >\r\n            {columns.map((col) => (\r\n              <BoardColumn\r\n                key={col.id}\r\n                column={col}\r\n                tasks={filteredTasks.filter((task) => task.columnId === col.id)}\r\n              />\r\n            ))}\r\n          </SortableContext>\r\n        </div>\r\n\r\n        {/* Drag Overlay */}\r\n        <DragOverlay dropAnimation={dropAnimation}>\r\n          {activeColumn && (\r\n            <BoardColumn\r\n              column={activeColumn}\r\n              tasks={tasks.filter((task) => task.columnId === activeColumn.id)}\r\n              isOverlay\r\n            />\r\n          )}\r\n          {activeTask && <TaskCard task={activeTask} isOverlay />}\r\n        </DragOverlay>\r\n      </DndContext>\r\n    </div>\r\n  );\r\n}\r\n\r\ninterface BoardColumnProps {\r\n  column: Column;\r\n  tasks: Task[];\r\n  isOverlay?: boolean;\r\n}\r\n\r\nfunction BoardColumn({ column, tasks, isOverlay }: BoardColumnProps) {\r\n  const {\r\n    setNodeRef,\r\n    attributes,\r\n    listeners,\r\n    transform,\r\n    transition,\r\n    isDragging,\r\n  } = useSortable({\r\n    id: column.id,\r\n    data: {\r\n      type: \"Column\",\r\n      column,\r\n    },\r\n  });\r\n\r\n  const style = {\r\n    transition,\r\n    transform: CSS.Translate.toString(transform),\r\n  };\r\n\r\n  const tasksIds = useMemo(() => tasks.map((task) => task.id), [tasks]);\r\n\r\n  return (\r\n    <div\r\n      ref={setNodeRef}\r\n      style={style}\r\n      className={cn(\r\n        \"group/column relative flex h-full w-[350px] min-w-[350px] flex-col overflow-hidden rounded-2xl border border-border/40 bg-background/50 backdrop-blur-xl shadow-lg\",\r\n        isDragging && \"opacity-50\",\r\n        isOverlay &&\r\n          \"rotate-2 scale-105 shadow-2xl cursor-grabbing bg-background/70\"\r\n      )}\r\n    >\r\n      {/* Gradient overlay for column */}\r\n      <div className=\"absolute inset-0 bg-gradient-to-br from-foreground/[0.03] via-transparent to-transparent opacity-0 transition-opacity duration-300 group-hover/column:opacity-100\" />\r\n\r\n      {/* Column Header */}\r\n      <div\r\n        {...attributes}\r\n        {...listeners}\r\n        className=\"relative z-10 flex items-center justify-between border-b border-border/30 bg-background/30 p-4 backdrop-blur-sm cursor-grab active:cursor-grabbing\"\r\n      >\r\n        <div className=\"flex items-center gap-2\">\r\n          <div className=\"flex h-6 w-6 items-center justify-center rounded-full bg-primary/20 text-xs font-bold text-primary shadow-sm shadow-primary/20 backdrop-blur-sm\">\r\n            {tasks.length}\r\n          </div>\r\n          <h3 className=\"font-semibold text-foreground\">{column.title}</h3>\r\n        </div>\r\n        <Button\r\n          variant=\"ghost\"\r\n          size=\"icon\"\r\n          className=\"h-8 w-8 text-foreground/40 hover:text-foreground hover:bg-background/50\"\r\n        >\r\n          <MoreHorizontal className=\"h-4 w-4\" />\r\n        </Button>\r\n      </div>\r\n\r\n      {/* Column Content */}\r\n      <div className=\"relative z-10 flex flex-1 flex-col gap-3 p-3\">\r\n        <SortableContext\r\n          items={tasksIds}\r\n          strategy={verticalListSortingStrategy}\r\n        >\r\n          {tasks.map((task) => (\r\n            <TaskCard key={task.id} task={task} />\r\n          ))}\r\n        </SortableContext>\r\n        <Button\r\n          variant=\"ghost\"\r\n          className=\"w-full justify-start gap-2 border border-dashed border-border/30 text-foreground/60 hover:text-foreground hover:bg-background/60 hover:border-border/50 backdrop-blur-sm\"\r\n        >\r\n          <Plus className=\"h-4 w-4\" />\r\n          Add Task\r\n        </Button>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\ninterface TaskCardProps {\r\n  task: Task;\r\n  isOverlay?: boolean;\r\n}\r\n\r\nfunction TaskCard({ task, isOverlay }: TaskCardProps) {\r\n  const {\r\n    setNodeRef,\r\n    attributes,\r\n    listeners,\r\n    transform,\r\n    transition,\r\n    isDragging,\r\n  } = useSortable({\r\n    id: task.id,\r\n    data: {\r\n      type: \"Task\",\r\n      task,\r\n    },\r\n  });\r\n\r\n  const style = {\r\n    transition,\r\n    transform: CSS.Translate.toString(transform),\r\n  };\r\n\r\n  const priorityColors = {\r\n    low: \"bg-blue-500/10 text-blue-600 dark:text-blue-400 border-blue-500/20\",\r\n    medium:\r\n      \"bg-amber-500/10 text-amber-600 dark:text-amber-400 border-amber-500/20\",\r\n    high: \"bg-red-500/10 text-red-600 dark:text-red-400 border-red-500/20\",\r\n  };\r\n\r\n  return (\r\n    <div\r\n      ref={setNodeRef}\r\n      style={style}\r\n      {...attributes}\r\n      {...listeners}\r\n      className={cn(\r\n        \"group relative flex cursor-grab flex-col gap-3 overflow-hidden rounded-xl border border-border/40 bg-background/70 p-4 shadow-lg backdrop-blur-xl transition-all hover:border-border/60 hover:shadow-xl hover:-translate-y-1 active:cursor-grabbing\",\r\n        isDragging && \"opacity-30\",\r\n        isOverlay &&\r\n          \"rotate-2 scale-105 shadow-2xl cursor-grabbing opacity-100 bg-background/90 backdrop-blur-xl z-50\"\r\n      )}\r\n    >\r\n      {/* Gradient overlay for card */}\r\n      <div className=\"absolute inset-0 bg-gradient-to-br from-foreground/[0.02] via-transparent to-transparent opacity-0 transition-opacity duration-300 group-hover:opacity-100\" />\r\n\r\n      {/* Header / Tags */}\r\n      <div className=\"relative z-10 flex items-start justify-between\">\r\n        <div className=\"flex flex-wrap gap-1.5\">\r\n          <Badge\r\n            variant=\"outline\"\r\n            className={cn(\r\n              \"border px-1.5 py-0.5 text-[10px] uppercase tracking-wider backdrop-blur-sm\",\r\n              priorityColors[task.priority]\r\n            )}\r\n          >\r\n            {task.priority}\r\n          </Badge>\r\n          {task.tags.map((tag) => (\r\n            <Badge\r\n              key={tag}\r\n              variant=\"secondary\"\r\n              className=\"bg-secondary/50 text-secondary-foreground/80 px-1.5 py-0.5 text-[10px] backdrop-blur-sm\"\r\n            >\r\n              {tag}\r\n            </Badge>\r\n          ))}\r\n        </div>\r\n        <Button\r\n          variant=\"ghost\"\r\n          size=\"icon\"\r\n          className=\"h-6 w-6 opacity-0 transition-opacity group-hover:opacity-100\"\r\n        >\r\n          <MoreHorizontal className=\"h-3 w-3\" />\r\n        </Button>\r\n      </div>\r\n\r\n      {/* Content */}\r\n      <p className=\"relative z-10 text-sm font-medium text-foreground leading-relaxed\">\r\n        {task.content}\r\n      </p>\r\n\r\n      {/* Footer */}\r\n      <div className=\"relative z-10 flex items-center justify-between pt-1\">\r\n        <div className=\"flex items-center gap-3 text-xs text-foreground/50\">\r\n          {task.dueDate && (\r\n            <div\r\n              className={cn(\r\n                \"flex items-center gap-1\",\r\n                task.priority === \"high\" && \"text-red-500/80\"\r\n              )}\r\n            >\r\n              <Clock className=\"h-3 w-3\" />\r\n              <span>{task.dueDate}</span>\r\n            </div>\r\n          )}\r\n          {(task.comments > 0 || task.attachments > 0) && (\r\n            <div className=\"flex items-center gap-2\">\r\n              {task.comments > 0 && (\r\n                <div className=\"flex items-center gap-1\">\r\n                  <MessageSquare className=\"h-3 w-3\" />\r\n                  <span>{task.comments}</span>\r\n                </div>\r\n              )}\r\n              {task.attachments > 0 && (\r\n                <div className=\"flex items-center gap-1\">\r\n                  <Paperclip className=\"h-3 w-3\" />\r\n                  <span>{task.attachments}</span>\r\n                </div>\r\n              )}\r\n            </div>\r\n          )}\r\n        </div>\r\n\r\n        {/* Assignees */}\r\n        {task.assignees.length > 0 && (\r\n          <div className=\"flex -space-x-2\">\r\n            {task.assignees.map((avatar, i) => (\r\n              <Avatar key={i} className=\"h-6 w-6 border-2 border-background\">\r\n                <AvatarImage src={avatar} />\r\n                <AvatarFallback className=\"text-[8px] bg-primary/10 text-primary\">\r\n                  U{i + 1}\r\n                </AvatarFallback>\r\n              </Avatar>\r\n            ))}\r\n          </div>\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n",
      "type": "registry:block",
      "target": "components/components/kanban/kanban-board"
    }
  ]
}